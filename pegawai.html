<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Pegawai</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f9;
        color: #333;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        min-height: 100vh;
      }

      a {
        color: #007bff;
        text-decoration: none;
        font-weight: bold;
        position: absolute;
        top: 20px;
        left: 20px;
      }

      h1 {
        margin-top: 60px;
        color: #343a40;
      }

      .container {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 20px;
        max-width: 1000px;
        width: 100%;
        align-items: flex-start;
      }

      .left-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .form-container {
        animation: slideInFromLeft 0.5s ease-in-out;
      }

      @keyframes slideInFromLeft {
        0% {
          transform: translateX(-100%);
          opacity: 0;
        }
        100% {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .form-container form {
        background-color: #ffffff;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .form-container form span {
        display: flex;
        flex-direction: column;
        flex: 1;
      }

      .form-container form label {
        margin-bottom: 5px;
        font-weight: bold;
      }

      .form-container form input {
        padding: 5px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 16px;
        width: 100%;
      }

      .form-container form button {
        background-color: #6e8658;
        color: white;
        padding: 6px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        align-self: flex-end;
      }

      .form-container form button:hover {
        background-color: #556744;
      }

      .table-container {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        animation: slideInFromLeft 0.5s ease-in-out;
      }

      main {
        width: 100%;
        overflow-x: auto;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        background-color: #ffffff;
        border-radius: 10px;
      }

      th,
      td {
        padding: 10px;
        border: 1px solid #ddd;
        text-align: left;
      }

      th {
        background-color: #6e8658;
        color: white;
      }

      tbody tr:nth-child(odd) {
        background-color: #f9f9f9;
      }

      tbody tr:hover {
        background-color: #f1f1f1;
      }

      .image-container {
        background-size: cover;
        display: flex;
        justify-content: center;
        align-items: center;
        animation: slideInFromRight 0.5s ease-in-out;
      }

      @keyframes slideInFromRight {
        0% {
          transform: translateX(100%);
          opacity: 0;
        }
        100% {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .image-container img {
        max-width: 100%;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      .btn-kembali {
        position: absolute;
        top: 20px;
        left: 20px;
        background-color: transparent;
        border: none;
        cursor: pointer;
        font-size: 1.5em;
        color: #6e8658;
        display: flex;
        align-items: center;
      }

      .btn-kembali:hover {
        color: #556744;
      }

      .btn {
        background-color: transparent;
        border: none;
        cursor: pointer;
        color: #6e8658;
        font-size: 1.2em;
      }

      .btn:hover {
        color: #556744;
      }

      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: #6e8658;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        display: none;
        z-index: 1000;
      }

      .notification.show {
        display: block;
      }
    </style>
  </head>
  <body>
    <button class="btn-kembali" onclick="window.history.back()">
      &#8592; Back
    </button>
    <h1>Data Pegawai</h1>
    <div class="container">
      <div class="left-container">
        <div class="form-container">
          <form>
            <span>
              <label for="nama">Nama</label>
              <input
                data-id
                id="nama"
                type="text"
                placeholder="Masukkan nama"
                required
              />
            </span>
            <span>
              <label for="nip">NIP</label>
              <input
                data-id
                id="nip"
                type="text"
                placeholder="Masukkan NIP"
                required
              />
            </span>
            <button type="submit">Simpan</button>
          </form>
        </div>
        <div class="table-container">
          <main>
            <table>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Nama</th>
                  <th>NIP</th>
                  <th colspan="2">Aksi</th>
                </tr>
              </thead>
              <tbody id="table-pegawai"></tbody>
            </table>
          </main>
        </div>
      </div>
      <div class="image-container">
        <img src="pegawai.png" alt="Pegawai" />
      </div>
    </div>
    <div id="notification" class="notification"></div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      const form = document.querySelector("form");
      const notification = document.getElementById("notification");

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        kirim();
      });

      function showNotification(message) {
        notification.innerText = message;
        notification.classList.add("show");
        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }

      function kirim() {
        const elemen_nama = document.querySelector("#nama");
        const elemen_nip = document.querySelector("#nip");

        const id = elemen_nama.dataset.id;
        const nama = elemen_nama.value;
        const nip = elemen_nip.value;

        if (id == "") {
          axios
            .post("https://pegawai-jmw7ojw7cq-et.a.run.app/pegawai", {
              nama,
              nip,
            })
            .then(() => {
              elemen_nama.dataset.id = "";
              elemen_nama.value = "";
              elemen_nip.value = "";
              getPegawai();
              showNotification("Pegawai berhasil ditambahkan.");
            })
            .catch((error) => {
              console.log(error.message);
              showNotification("Gagal menambahkan pegawai.");
            });
        } else {
          axios
            .put(`https://pegawai-jmw7ojw7cq-et.a.run.app/pegawai/${id}`, {
              nama,
              nip,
            })
            .then(() => {
              elemen_nama.dataset.id = "";
              elemen_nama.value = "";
              elemen_nip.value = "";
              getPegawai();
              showNotification("Pegawai berhasil diupdate.");
            })
            .catch((error) => {
              console.log(error);
              showNotification("Gagal mengupdate pegawai.");
            });
        }
      }

      function getPegawai() {
        axios
          .get("https://pegawai-jmw7ojw7cq-et.a.run.app/pegawai")
          .then(({ data }) => {
            const table = document.querySelector("#table-pegawai");
            const { data: pegawai } = data;
            let tampilan = "";

            pegawai.forEach((item, index) => {
              tampilan += `
                <tr>
                  <td>${index + 1}</td>
                  <td>${item.nama}</td>
                  <td>${item.nip}</td>
                  <td><button class="btn" onclick="editPegawai('${item.id}', '${
                item.nama
              }', '${item.nip}')">&#9998;</button></td>
                  <td><button class="btn" onclick="hapusPegawai('${
                    item.id
                  }')">&#10060;</button></td>
                </tr>
              `;
            });
            table.innerHTML = tampilan;
          })
          .catch((error) => {
            console.log(error.message);
          });
      }

      function editPegawai(id, nama, nip) {
        const elemen_nama = document.querySelector("#nama");
        const elemen_nip = document.querySelector("#nip");

        elemen_nama.dataset.id = id;
        elemen_nama.value = nama;
        elemen_nip.value = nip;
      }

      function hapusPegawai(id) {
        if (confirm("Apakah Anda yakin ingin menghapus pegawai ini?")) {
          axios
            .delete(`https://pegawai-jmw7ojw7cq-et.a.run.app/pegawai/${id}`)
            .then(() => {
              getPegawai();
              showNotification("Pegawai berhasil dipecat.");
            })
            .catch((error) => {
              console.log(error);
              showNotification("Gagal memecat pegawai.");
            });
        }
      }

      getPegawai();
    </script>
  </body>
</html>
